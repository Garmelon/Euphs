<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Euphs.Bot</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Euphs-Bot.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">Euphs-0.0.2: A framework for writing bots for euphoria.io.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Euphs.Bot</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Structures and type synonyms</a></li><li><a href="#g:2">Main Functions</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Provides a framework to build bots connecting to <a href="https://github.com/euphoria-io/heim">heim</a>.
 This module is still a bit unstable, and between API changes, it will break a lot.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:Bot">Bot</a> = <a href="#v:Bot">Bot</a> {<ul class="subs"><li><a href="#v:botConnection">botConnection</a> :: <a href="http://hackage.haskell.org/packages/archive/websockets/0.9.6.1/doc/html/Network-WebSockets-Connection.html#t:Connection">Connection</a></li><li><a href="#v:packetCount">packetCount</a> :: <a href="Euphs-Bot.html#t:PacketID">PacketID</a></li><li><a href="#v:botAgent">botAgent</a> :: <a href="Euphs-Bot.html#t:BotAgent">BotAgent</a></li><li><a href="#v:botRoom">botRoom</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-String.html#t:String">String</a></li><li><a href="#v:botName">botName</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-String.html#t:String">String</a></li><li><a href="#v:startTime">startTime</a> :: <a href="http://hackage.haskell.org/packages/archive/time/1.5.0.1/doc/html/Data-Time-Clock.html#t:UTCTime">UTCTime</a></li><li><a href="#v:botFun">botFun</a> :: <a href="Euphs-Bot.html#t:BotFunctions">BotFunctions</a></li><li><a href="#v:sideThreads">sideThreads</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/GHC-Conc.html#t:TVar">TVar</a> [<a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Control-Concurrent.html#t:ThreadId">ThreadId</a>]</li><li><a href="#v:logHandle">logHandle</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/GHC-IO-Handle.html#t:Handle">Handle</a></li><li><a href="#v:evtQueue">evtQueue</a> :: <a href="http://hackage.haskell.org/packages/archive/stm/2.4.4/doc/html/Control-Concurrent-STM-TQueue.html#t:TQueue">TQueue</a> <a href="Euphs-Events.html#t:EuphEvent">EuphEvent</a></li><li><a href="#v:roomPW">roomPW</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-String.html#t:String">String</a></li><li><a href="#v:closeVar">closeVar</a> :: <a href="http://hackage.haskell.org/packages/archive/stm/2.4.4/doc/html/Control-Concurrent-STM-TChan.html#t:TChan">TChan</a> ()</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:BotFunctions">BotFunctions</a> = <a href="#v:BotFunctions">BotFunctions</a> {<ul class="subs"><li><a href="#v:eventsHook">eventsHook</a> :: <a href="Euphs-Events.html#t:EuphEvent">EuphEvent</a> -&gt; <a href="Euphs-Bot.html#t:Net">Net</a> ()</li><li><a href="#v:dcHook">dcHook</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ())</li><li><a href="#v:helpShortHook">helpShortHook</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> ([<a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-String.html#t:String">String</a>] -&gt; <a href="Euphs-Bot.html#t:Net">Net</a> <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-String.html#t:String">String</a>)</li><li><a href="#v:helpLongHook">helpLongHook</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> ([<a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-String.html#t:String">String</a>] -&gt; <a href="Euphs-Bot.html#t:Net">Net</a> <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-String.html#t:String">String</a>)</li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:Net">Net</a> = <a href="http://hackage.haskell.org/packages/archive/mtl/2.2.1/doc/html/Control-Monad-Reader.html#t:ReaderT">ReaderT</a> <a href="Euphs-Bot.html#t:Bot">Bot</a> <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:BotAgent">BotAgent</a> = <a href="http://hackage.haskell.org/packages/archive/stm/2.4.4/doc/html/Control-Concurrent-STM-TMVar.html#t:TMVar">TMVar</a> <a href="Euphs-Types.html#t:UserData">UserData</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:PacketID">PacketID</a> = <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/GHC-Conc.html#t:TVar">TVar</a> <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:bot">bot</a> :: <a href="Euphs-Bot.html#t:BotFunctions">BotFunctions</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:botWithOpts">botWithOpts</a> :: <a href="Euphs-Bot.html#t:BotFunctions">BotFunctions</a> -&gt; <a href="Euphs-Options.html#t:Opts">Opts</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:closeBot">closeBot</a> :: <a href="Euphs-Bot.html#t:Net">Net</a> ()</li><li class="src short"><a href="#v:disconnect">disconnect</a> :: <a href="Euphs-Bot.html#t:BotFunctions">BotFunctions</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:emptyBot">emptyBot</a> :: <a href="Euphs-Bot.html#t:BotFunctions">BotFunctions</a></li><li class="src short"><a href="#v:getBotAgent">getBotAgent</a> :: <a href="Euphs-Bot.html#t:Net">Net</a> <a href="Euphs-Types.html#t:UserData">UserData</a></li><li class="src short"><a href="#v:sendPacket">sendPacket</a> :: <a href="Euphs-Commands.html#t:EuphCommand">EuphCommand</a> -&gt; <a href="Euphs-Bot.html#t:Net">Net</a> <a href="Euphs-Events.html#t:EuphEvent">EuphEvent</a></li><li class="src short"><a href="#v:getBotConfig">getBotConfig</a> :: <a href="http://hackage.haskell.org/packages/archive/aeson/0.10.0.0/doc/html/Data-Aeson-Types.html#t:FromJSON">FromJSON</a> a =&gt; <a href="Euphs-Options.html#t:Opts">Opts</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> (<a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> a)</li><li class="src short"><a href="#v:tellLog">tellLog</a> :: <a href="http://hackage.haskell.org/packages/archive/text/1.2.1.3/doc/html/Data-Text.html#t:Text">Text</a> -&gt; <a href="Euphs-Bot.html#t:Net">Net</a> ()</li><li class="src short"><a href="#v:sendReply">sendReply</a> :: <a href="Euphs-Types.html#t:MessageData">MessageData</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="Euphs-Bot.html#t:Net">Net</a> <a href="Euphs-Events.html#t:EuphEvent">EuphEvent</a></li></ul></div><div id="interface"><h2 id="g:1">Structures and type synonyms</h2><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Bot" class="def">Bot</a></p><div class="doc"><p>The main Bot data structure.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Bot" class="def">Bot</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:botConnection" class="def">botConnection</a> :: <a href="http://hackage.haskell.org/packages/archive/websockets/0.9.6.1/doc/html/Network-WebSockets-Connection.html#t:Connection">Connection</a></dt><dd class="doc"><p>Websocket connection to heim.</p></dd><dt class="src"><a name="v:packetCount" class="def">packetCount</a> :: <a href="Euphs-Bot.html#t:PacketID">PacketID</a></dt><dd class="doc"><p>The packet counter</p></dd><dt class="src"><a name="v:botAgent" class="def">botAgent</a> :: <a href="Euphs-Bot.html#t:BotAgent">BotAgent</a></dt><dd class="doc"><p>The Bot agent given from the server</p></dd><dt class="src"><a name="v:botRoom" class="def">botRoom</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-String.html#t:String">String</a></dt><dd class="doc"><p>The room the bot currently is in.</p></dd><dt class="src"><a name="v:botName" class="def">botName</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-String.html#t:String">String</a></dt><dd class="doc"><p>Initial bot nick</p></dd><dt class="src"><a name="v:startTime" class="def">startTime</a> :: <a href="http://hackage.haskell.org/packages/archive/time/1.5.0.1/doc/html/Data-Time-Clock.html#t:UTCTime">UTCTime</a></dt><dd class="doc"><p>Time at which the bot was started</p></dd><dt class="src"><a name="v:botFun" class="def">botFun</a> :: <a href="Euphs-Bot.html#t:BotFunctions">BotFunctions</a></dt><dd class="doc"><p>Custom bot functions</p></dd><dt class="src"><a name="v:sideThreads" class="def">sideThreads</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/GHC-Conc.html#t:TVar">TVar</a> [<a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Control-Concurrent.html#t:ThreadId">ThreadId</a>]</dt><dd class="doc"><p>An experimental way to keep track of the threads spawned</p></dd><dt class="src"><a name="v:logHandle" class="def">logHandle</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/GHC-IO-Handle.html#t:Handle">Handle</a></dt><dd class="doc"><p>Logging handle</p></dd><dt class="src"><a name="v:evtQueue" class="def">evtQueue</a> :: <a href="http://hackage.haskell.org/packages/archive/stm/2.4.4/doc/html/Control-Concurrent-STM-TQueue.html#t:TQueue">TQueue</a> <a href="Euphs-Events.html#t:EuphEvent">EuphEvent</a></dt><dd class="doc"><p>Queue of reply events</p></dd><dt class="src"><a name="v:roomPW" class="def">roomPW</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-String.html#t:String">String</a></dt><dd class="doc"><p>Room password</p></dd><dt class="src"><a name="v:closeVar" class="def">closeVar</a> :: <a href="http://hackage.haskell.org/packages/archive/stm/2.4.4/doc/html/Control-Concurrent-STM-TChan.html#t:TChan">TChan</a> ()</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:BotFunctions" class="def">BotFunctions</a></p><div class="doc"><p>Custom Bot functions</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:BotFunctions" class="def">BotFunctions</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:eventsHook" class="def">eventsHook</a> :: <a href="Euphs-Events.html#t:EuphEvent">EuphEvent</a> -&gt; <a href="Euphs-Bot.html#t:Net">Net</a> ()</dt><dd class="doc"><p>Main event loop. Every event not handled by the bot, calls this function.</p></dd><dt class="src"><a name="v:dcHook" class="def">dcHook</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ())</dt><dd class="doc"><p>Special actions to run in a disconnect, for cleanup.</p></dd><dt class="src"><a name="v:helpShortHook" class="def">helpShortHook</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> ([<a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-String.html#t:String">String</a>] -&gt; <a href="Euphs-Bot.html#t:Net">Net</a> <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-String.html#t:String">String</a>)</dt><dd class="doc"><p>A short !help description</p></dd><dt class="src"><a name="v:helpLongHook" class="def">helpLongHook</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> ([<a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-String.html#t:String">String</a>] -&gt; <a href="Euphs-Bot.html#t:Net">Net</a> <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-String.html#t:String">String</a>)</dt><dd class="doc"><p>A long !help <a href="botName">botName</a> description</p></dd></dl><div class="clear"></div></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Net" class="def">Net</a> = <a href="http://hackage.haskell.org/packages/archive/mtl/2.2.1/doc/html/Control-Monad-Reader.html#t:ReaderT">ReaderT</a> <a href="Euphs-Bot.html#t:Bot">Bot</a> <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a></p><div class="doc"><p>The monad transformer stack, for handling all the bot events</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:BotAgent" class="def">BotAgent</a> = <a href="http://hackage.haskell.org/packages/archive/stm/2.4.4/doc/html/Control-Concurrent-STM-TMVar.html#t:TMVar">TMVar</a> <a href="Euphs-Types.html#t:UserData">UserData</a></p><div class="doc"><p>The mutable bot agent</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:PacketID" class="def">PacketID</a> = <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/GHC-Conc.html#t:TVar">TVar</a> <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Int.html#t:Int">Int</a></p><div class="doc"><p>A mutable counter for packet ids</p></div></div><h2 id="g:2">Main Functions</h2><div class="top"><p class="src"><a name="v:bot" class="def">bot</a> :: <a href="Euphs-Bot.html#t:BotFunctions">BotFunctions</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</p><div class="doc"><p>The main bot call function. When this action ends, the bot is closed.</p></div></div><div class="top"><p class="src"><a name="v:botWithOpts" class="def">botWithOpts</a> :: <a href="Euphs-Bot.html#t:BotFunctions">BotFunctions</a> -&gt; <a href="Euphs-Options.html#t:Opts">Opts</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</p><div class="doc"><p>Function for calling the bot with custom options, using a getOpts call.</p></div></div><div class="top"><p class="src"><a name="v:closeBot" class="def">closeBot</a> :: <a href="Euphs-Bot.html#t:Net">Net</a> ()</p><div class="doc"><p>Function for closing the bot from inside the Net monad</p></div></div><div class="top"><p class="src"><a name="v:disconnect" class="def">disconnect</a> :: <a href="Euphs-Bot.html#t:BotFunctions">BotFunctions</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</p><div class="doc"><p>Function for closing off the bot.</p></div></div><div class="top"><p class="src"><a name="v:emptyBot" class="def">emptyBot</a> :: <a href="Euphs-Bot.html#t:BotFunctions">BotFunctions</a></p><div class="doc"><p>Empty bot</p></div></div><div class="top"><p class="src"><a name="v:getBotAgent" class="def">getBotAgent</a> :: <a href="Euphs-Bot.html#t:Net">Net</a> <a href="Euphs-Types.html#t:UserData">UserData</a></p><div class="doc"><p>An easier way to read the current bot agent</p></div></div><div class="top"><p class="src"><a name="v:sendPacket" class="def">sendPacket</a> :: <a href="Euphs-Commands.html#t:EuphCommand">EuphCommand</a> -&gt; <a href="Euphs-Bot.html#t:Net">Net</a> <a href="Euphs-Events.html#t:EuphEvent">EuphEvent</a></p><div class="doc"><p>Sends an Heim command, and fetches the reply.</p></div></div><div class="top"><p class="src"><a name="v:getBotConfig" class="def">getBotConfig</a> :: <a href="http://hackage.haskell.org/packages/archive/aeson/0.10.0.0/doc/html/Data-Aeson-Types.html#t:FromJSON">FromJSON</a> a =&gt; <a href="Euphs-Options.html#t:Opts">Opts</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> (<a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> a)</p><div class="doc"><p>Interface to the YAML parser, using the Bot commanline interface</p></div></div><div class="top"><p class="src"><a name="v:tellLog" class="def">tellLog</a> :: <a href="http://hackage.haskell.org/packages/archive/text/1.2.1.3/doc/html/Data-Text.html#t:Text">Text</a> -&gt; <a href="Euphs-Bot.html#t:Net">Net</a> ()</p><div class="doc"><p>Logging information to the log handle.</p></div></div><div class="top"><p class="src"><a name="v:sendReply" class="def">sendReply</a> :: <a href="Euphs-Types.html#t:MessageData">MessageData</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="Euphs-Bot.html#t:Net">Net</a> <a href="Euphs-Events.html#t:EuphEvent">EuphEvent</a></p><div class="doc"><p>Convenience function for sendPacket $ Send str (msgID m)</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>